<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Kitchen Dashboard - Enhanced</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); 
            min-height: 100vh; 
            color: #2c3e50; 
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        /* Kitchen Header */
        .kitchen-header { 
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); 
            color: white; 
            padding: 30px; 
            border-radius: 15px; 
            margin-bottom: 30px; 
            text-align: center; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); 
        }
        .kitchen-title { 
            font-size: 3rem; 
            font-weight: bold; 
            margin-bottom: 10px; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3); 
        }
        .kitchen-subtitle { 
            font-size: 1.3rem; 
            opacity: 0.9; 
            margin-bottom: 20px; 
        }
        .credentials-info { 
            background: rgba(255,255,255,0.1); 
            padding: 15px; 
            border-radius: 10px; 
            font-size: 0.9rem; 
            margin-top: 15px; 
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            text-align: left;
        }
        .credential-item { 
            background: rgba(255,255,255,0.1); 
            padding: 10px; 
            border-radius: 8px; 
            font-family: monospace;
            font-size: 0.8rem;
        }

        /* Statistics Dashboard */
        .stats-dashboard { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .stat-card { 
            background: white; 
            padding: 25px; 
            border-radius: 15px; 
            text-align: center; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.1); 
            border-left: 5px solid #e74c3c; 
            transition: all 0.3s ease; 
        }
        .stat-card:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 12px 35px rgba(0,0,0,0.15); 
        }
        .stat-number { 
            font-size: 2.5rem; 
            font-weight: bold; 
            color: #e74c3c; 
            margin-bottom: 10px; 
        }
        .stat-label { 
            font-size: 1rem; 
            color: #7f8c8d; 
            font-weight: 500; 
        }

        /* Cloud Status */
        .cloud-status { 
            background: white; 
            padding: 20px; 
            border-radius: 12px; 
            margin-bottom: 30px; 
            text-align: center; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            border: 2px solid #27ae60; 
        }
        .cloud-status.fetching { 
            border-color: #f39c12; 
            background: #fff9e6; 
        }
        .cloud-status.error { 
            border-color: #e74c3c; 
            background: #ffebee; 
        }
        .status-text { 
            font-size: 1.1rem; 
            font-weight: 600; 
            color: #2c3e50; 
        }

        /* Orders Section */
        .orders-section { 
            background: white; 
            border-radius: 15px; 
            padding: 30px; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.1); 
            margin-bottom: 30px; 
        }
        .section-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 25px; 
            padding-bottom: 15px; 
            border-bottom: 2px solid #ecf0f1; 
        }
        .section-title { 
            font-size: 2rem; 
            font-weight: bold; 
            color: #2c3e50; 
        }
        .refresh-btn { 
            background: linear-gradient(45deg, #3498db, #2980b9); 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: 600; 
            font-size: 1rem; 
            transition: all 0.3s ease; 
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3); 
        }
        .refresh-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4); 
        }
        .refresh-btn:disabled { 
            background: #bdc3c7; 
            cursor: not-allowed; 
            transform: none; 
            box-shadow: none; 
        }

        /* Order Cards */
        .orders-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(450px, 1fr)); 
            gap: 25px; 
        }
        .order-card { 
            background: #fafbfc; 
            border: 2px solid #e1e8ed; 
            border-radius: 15px; 
            padding: 25px; 
            transition: all 0.3s ease; 
            position: relative; 
            overflow: hidden; 
        }
        .order-card::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 6px; 
            height: 100%; 
            background: #e74c3c; 
        }
        .order-card.cooking::before { background: #f39c12; }
        .order-card.ready::before { background: #27ae60; }
        .order-card.served::before { background: #8e44ad; }
        .order-card.completed { 
            background: #f8f9fa; 
            border-color: #28a745; 
            opacity: 0.8;
        }
        .order-card.completed::before { background: #28a745; }

        .order-card:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 12px 35px rgba(0,0,0,0.15); 
        }

        .order-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px; 
        }
        .table-number { 
            font-size: 1.6rem; 
            font-weight: bold; 
            color: #2c3e50; 
            background: #ecf0f1; 
            padding: 10px 20px; 
            border-radius: 25px; 
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .order-time { 
            font-size: 1rem; 
            color: #7f8c8d; 
            background: white; 
            padding: 8px 15px; 
            border-radius: 20px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
            font-weight: 600;
        }

        .order-number { 
            font-size: 1.2rem; 
            color: #34495e; 
            margin-bottom: 15px; 
            background: #d5dbdb; 
            padding: 12px; 
            border-radius: 8px; 
            font-family: monospace; 
            font-weight: bold;
            text-align: center;
        }

        .order-items { 
            background: #fff5f5; 
            border: 2px solid #fadbd8; 
            padding: 20px; 
            border-radius: 10px; 
            margin-bottom: 20px; 
        }
        .items-header { 
            font-size: 1.2rem; 
            font-weight: bold; 
            color: #c0392b; 
            margin-bottom: 15px; 
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .item-list { 
            line-height: 2; 
            color: #2c3e50; 
            font-size: 1rem;
        }
        .item-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1c0bd;
        }
        .item-row:last-child {
            border-bottom: none;
        }
        .item-name { font-weight: 600; }
        .item-details { color: #7f8c8d; font-size: 0.9rem; }
        .item-total { font-weight: bold; color: #e74c3c; }

        .order-total { 
            text-align: center; 
            font-size: 1.6rem; 
            font-weight: bold; 
            color: #27ae60; 
            background: #eafaf1; 
            padding: 20px; 
            border-radius: 10px; 
            margin-bottom: 25px; 
            border: 2px solid #a9dfbf;
        }

        /* Action Buttons */
        .action-buttons { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); 
            gap: 12px; 
        }
        .action-btn { 
            padding: 14px 20px; 
            border: none; 
            border-radius: 8px; 
            font-weight: 600; 
            font-size: 0.95rem; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            text-align: center; 
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        .cooking-btn { 
            background: linear-gradient(45deg, #f39c12, #e67e22); 
            color: white; 
        }
        .cooking-btn:hover { 
            background: linear-gradient(45deg, #e67e22, #d35400); 
            transform: translateY(-2px); 
        }
        .ready-btn { 
            background: linear-gradient(45deg, #27ae60, #229954); 
            color: white; 
        }
        .ready-btn:hover { 
            background: linear-gradient(45deg, #229954, #1e8449); 
            transform: translateY(-2px); 
        }
        .served-btn { 
            background: linear-gradient(45deg, #8e44ad, #7d3c98); 
            color: white; 
        }
        .served-btn:hover { 
            background: linear-gradient(45deg, #7d3c98, #6c3483); 
            transform: translateY(-2px); 
        }
        .complete-btn { 
            background: linear-gradient(45deg, #28a745, #218838); 
            color: white; 
        }
        .complete-btn:hover { 
            background: linear-gradient(45deg, #218838, #1e7e34); 
            transform: translateY(-2px); 
        }
        .action-btn:disabled { 
            background: #bdc3c7 !important; 
            color: #7f8c8d !important; 
            cursor: not-allowed; 
            transform: none; 
        }

        /* Status badges */
        .status-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }
        .status-new { background: #e74c3c; color: white; }
        .status-cooking { background: #f39c12; color: white; }
        .status-ready { background: #27ae60; color: white; }
        .status-served { background: #8e44ad; color: white; }
        .status-completed { background: #28a745; color: white; }

        /* Empty State */
        .empty-state { 
            text-align: center; 
            padding: 60px 40px; 
            color: #7f8c8d; 
        }
        .empty-icon { 
            font-size: 5rem; 
            margin-bottom: 20px; 
            opacity: 0.6; 
        }
        .empty-title { 
            font-size: 1.8rem; 
            font-weight: bold; 
            margin-bottom: 15px; 
            color: #34495e; 
        }
        .empty-description { 
            font-size: 1.1rem; 
            line-height: 1.6; 
        }

        /* Loading Animation */
        .spinner { 
            display: inline-block; 
            width: 20px; 
            height: 20px; 
            border: 3px solid #f3f3f3; 
            border-top: 3px solid #e74c3c; 
            border-radius: 50%; 
            animation: spin 1s linear infinite; 
            margin-right: 10px; 
        }
        @keyframes spin { 
            0% { transform: rotate(0deg); } 
            100% { transform: rotate(360deg); } 
        }

        /* Auto-refresh indicator */
        .auto-refresh { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: rgba(46, 204, 113, 0.9); 
            color: white; 
            padding: 12px 20px; 
            border-radius: 25px; 
            font-size: 0.9rem; 
            font-weight: 600; 
            z-index: 1000; 
            transition: all 0.3s ease; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .auto-refresh.fetching { 
            background: rgba(241, 196, 15, 0.9); 
        }

        /* Responsive Design */
        @media (max-width: 768px) { 
            .container { padding: 15px; } 
            .kitchen-title { font-size: 2.5rem; } 
            .orders-grid { grid-template-columns: 1fr; } 
            .order-card { padding: 20px; } 
            .stats-dashboard { grid-template-columns: repeat(2, 1fr); } 
            .action-buttons { grid-template-columns: 1fr 1fr; }
            .credentials-info { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Kitchen Header -->
        <header class="kitchen-header">
            <h1 class="kitchen-title">üçΩÔ∏è Enhanced Kitchen Dashboard</h1>
            <p class="kitchen-subtitle">Complete Order Management with Cloud Deletion</p>
            <div class="credentials-info">
                <div class="credential-item">
                    <strong>üîë API Status:</strong><br>
                    Pre-configured & Active
                </div>
                <div class="credential-item">
                    <strong>üì¶ Bin ID:</strong><br>
                    68d3f7c643b1c97be94e5143
                </div>
                <div class="credential-item">
                    <strong>üîÑ Auto-Sync:</strong><br>
                    Every 5 seconds
                </div>
                <div class="credential-item">
                    <strong>üóëÔ∏è Cloud Deletion:</strong><br>
                    Enabled
                </div>
            </div>
        </header>

        <!-- Statistics Dashboard -->
        <div class="stats-dashboard">
            <div class="stat-card">
                <div class="stat-number" id="activeOrders">0</div>
                <div class="stat-label">Active Orders</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeTables">0</div>
                <div class="stat-label">Active Tables</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalOrders">0</div>
                <div class="stat-label">Total Orders</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedOrders">0</div>
                <div class="stat-label">Completed Orders</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="currentTime">--:--</div>
                <div class="stat-label">Current Time</div>
            </div>
        </div>

        <!-- Cloud Status -->
        <div id="cloudStatus" class="cloud-status">
            <div class="status-text">‚òÅÔ∏è Enhanced kitchen system ready - Waiting for orders...</div>
        </div>

        <!-- Auto-refresh indicator -->
        <div id="autoRefresh" class="auto-refresh">
            üîÑ Auto-sync: ON
        </div>

        <!-- Orders Section -->
        <div class="orders-section">
            <div class="section-header">
                <h2 class="section-title">üìã Kitchen Orders (Enhanced)</h2>
                <button id="manualRefresh" class="refresh-btn" onclick="fetchOrdersManually()">
                    üîÑ Refresh Now
                </button>
            </div>

            <div id="ordersContainer">
                <!-- Orders will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // ‚úÖ PRE-CONFIGURED WITH YOUR CREDENTIALS
        const CLOUD_CONFIG = {
            jsonBinApiKey: '$2a$10$sKN1nZNUuRh7v7M1gYrZNuBbPKkXMf7i/hWYKyBlkZ8RJV9r/VgAi',
            binId: '68d3f7c643b1c97be94e5143',
            baseUrl: 'https://api.jsonbin.io/v3/b'
        };

        // Kitchen state
        let orders = [];
        let processedOrderIds = new Set();
        let totalOrdersCount = 0;
        let completedOrdersCount = 0;
        let isAutoRefresh = true;
        let autoRefreshInterval;

        // Initialize enhanced kitchen system
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üçΩÔ∏è Enhanced kitchen dashboard initializing...');
            console.log('üîë API configured:', CLOUD_CONFIG.jsonBinApiKey.substring(0, 20) + '...');
            console.log('üì¶ Bin ID:', CLOUD_CONFIG.binId);
            console.log('üóëÔ∏è Cloud deletion enabled');

            startClock();
            startAutoRefresh();
            fetchOrdersFromCloud();

            showCloudStatus('‚úÖ Enhanced kitchen dashboard ready - Pre-configured with cloud deletion', 'success');
        });

        // Start real-time clock
        function startClock() {
            function updateTime() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('en-IN', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                document.getElementById('currentTime').textContent = timeStr;
            }
            updateTime();
            setInterval(updateTime, 1000);
        }

        // Start auto-refresh
        function startAutoRefresh() {
            autoRefreshInterval = setInterval(() => {
                if (isAutoRefresh) {
                    fetchOrdersFromCloud(true);
                }
            }, 5000); // Every 5 seconds
        }

        // Fetch orders from your pre-configured cloud
        async function fetchOrdersFromCloud(isAuto = false) {
            if (!isAuto) {
                document.getElementById('manualRefresh').disabled = true;
                document.getElementById('manualRefresh').innerHTML = '<div class="spinner"></div>Refreshing...';
            }

            const autoRefreshEl = document.getElementById('autoRefresh');
            if (isAuto) {
                autoRefreshEl.className = 'auto-refresh fetching';
                autoRefreshEl.textContent = 'üîÑ Syncing...';
            }

            showCloudStatus('‚òÅÔ∏è Fetching new orders from cloud...', 'fetching');

            try {
                // Fetch from your pre-configured JSONBin
                const response = await fetch(`${CLOUD_CONFIG.baseUrl}/${CLOUD_CONFIG.binId}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': CLOUD_CONFIG.jsonBinApiKey,
                        'X-Bin-Meta': 'false'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const cloudData = await response.json();

                if (cloudData && cloudData.orders) {
                    let newOrdersCount = 0;

                    // Process each order from cloud
                    cloudData.orders.forEach(orderData => {
                        const orderId = `${orderData.orderNumber}_${orderData.tableNumber}`;

                        if (!processedOrderIds.has(orderId) && orderData.status === 'new') {
                            addNewOrder(orderData);
                            processedOrderIds.add(orderId);
                            newOrdersCount++;
                        }
                    });

                    if (newOrdersCount > 0) {
                        showCloudStatus(`üÜï ${newOrdersCount} new orders received from cloud!`, 'success');
                        // Play notification sound (if supported)
                        try {
                            new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwgBSpT0/bOdCgKLnPa7Z5iGwxKsNvv2oMiDDNj1+qtXBkJOm+s' ).play();
                        } catch (e) {}
                    } else if (!isAuto) {
                        showCloudStatus('‚òÅÔ∏è No new orders - Kitchen up to date', 'success');
                    } else {
                        showCloudStatus('‚òÅÔ∏è Cloud monitoring active - No new orders', 'success');
                    }
                } else {
                    showCloudStatus('‚òÅÔ∏è Cloud connected - Waiting for new orders...', 'success');
                }

                updateStatistics();

            } catch (error) {
                console.error('‚ùå Cloud fetch error:', error);
                showCloudStatus(`‚ùå Cloud error: ${error.message}`, 'error');
            } finally {
                if (!isAuto) {
                    document.getElementById('manualRefresh').disabled = false;
                    document.getElementById('manualRefresh').innerHTML = 'üîÑ Refresh Now';
                }

                if (isAuto) {
                    autoRefreshEl.className = 'auto-refresh';
                    autoRefreshEl.textContent = 'üîÑ Auto-sync: ON';
                }
            }
        }

        // Add new order to kitchen
        function addNewOrder(orderData) {
            orders.unshift(orderData);
            totalOrdersCount++;
            renderOrders();
        }

        // Render all orders with enhanced display
        function renderOrders() {
            const container = document.getElementById('ordersContainer');

            if (orders.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üçΩÔ∏è</div>
                        <div class="empty-title">Enhanced Kitchen Ready</div>
                        <div class="empty-description">
                            Your enhanced cloud kitchen dashboard is ready!<br>
                            Orders from customers will appear here automatically.<br>
                            <strong>Auto-sync every 5 seconds ‚Ä¢ Cloud deletion enabled</strong>
                        </div>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                <div class="orders-grid">
                    ${orders.map(order => createEnhancedOrderCard(order)).join('')}
                </div>
            `;
        }

        // Create enhanced order card HTML
        function createEnhancedOrderCard(order) {
            const itemsHtml = order.items.map(item => `
                <div class="item-row">
                    <div>
                        <div class="item-name">${item.name}</div>
                        <div class="item-details">‚Çπ${item.price.toFixed(0)} √ó ${item.quantity}</div>
                    </div>
                    <div class="item-total">‚Çπ${(item.quantity * item.price).toFixed(0)}</div>
                </div>
            `).join('');

            const statusText = {
                'new': 'NEW',
                'cooking': 'COOKING',
                'ready': 'READY', 
                'served': 'SERVED',
                'completed': 'COMPLETED'
            }[order.status] || 'NEW';

            return `
                <div class="order-card ${order.status}" id="order_${order.orderNumber}">
                    <div class="status-badge status-${order.status}">${statusText}</div>

                    <div class="order-header">
                        <div class="table-number">
                            ü™ë Table ${order.tableNumber}
                        </div>
                        <div class="order-time">${order.orderTime}</div>
                    </div>

                    <div class="order-number">üìã Order #${order.orderNumber}</div>

                    <div class="order-items">
                        <div class="items-header">
                            üçΩÔ∏è Ordered Items (${order.items.length} items)
                        </div>
                        <div class="item-list">
                            ${itemsHtml}
                        </div>
                    </div>

                    <div class="order-total">üí∞ Total Amount: ‚Çπ${order.total}</div>

                    <div class="action-buttons">
                        <button class="action-btn cooking-btn" 
                                onclick="updateOrderStatus('${order.orderNumber}', 'cooking')"
                                ${order.status !== 'new' ? 'disabled' : ''}>
                            üë®‚Äçüç≥ ${order.status === 'new' ? 'Start Cooking' : 'Cooking...'}
                        </button>
                        <button class="action-btn ready-btn" 
                                onclick="updateOrderStatus('${order.orderNumber}', 'ready')"
                                ${order.status !== 'cooking' ? 'disabled' : ''}>
                            ‚úÖ ${order.status === 'cooking' ? 'Mark Ready' : 'Ready'}
                        </button>
                        <button class="action-btn served-btn" 
                                onclick="updateOrderStatus('${order.orderNumber}', 'served')"
                                ${order.status !== 'ready' ? 'disabled' : ''}>
                            üçΩÔ∏è ${order.status === 'ready' ? 'Mark Served' : 'Served'}
                        </button>
                        <button class="action-btn complete-btn" 
                                onclick="completeOrder('${order.orderNumber}')"
                                ${order.status !== 'served' ? 'disabled' : ''}>
                            ‚úÖ ${order.status === 'served' ? 'Complete & Delete' : 'Complete'}
                        </button>
                    </div>
                </div>
            `;
        }

        // Update order status
        function updateOrderStatus(orderNumber, newStatus) {
            const order = orders.find(o => o.orderNumber === orderNumber);
            if (!order) return;

            order.status = newStatus;
            renderOrders();
            updateStatistics();

            const statusMessages = {
                'cooking': `üë®‚Äçüç≥ Table ${order.tableNumber} order is now cooking`,
                'ready': `‚úÖ Table ${order.tableNumber} order is ready for serving!`,
                'served': `üçΩÔ∏è Table ${order.tableNumber} order has been served - Ready to complete`
            };

            showCloudStatus(statusMessages[newStatus], 'success');
        }

        // üóëÔ∏è COMPLETE ORDER AND DELETE FROM CLOUD
        async function completeOrder(orderNumber) {
            const order = orders.find(o => o.orderNumber === orderNumber);
            if (!order || order.status !== 'served') return;

            if (!confirm(`Complete order #${orderNumber} for Table ${order.tableNumber} and delete from cloud?`)) {
                return;
            }

            showCloudStatus(`üóëÔ∏è Completing order #${orderNumber} and deleting from cloud...`, 'fetching');

            try {
                // First get current cloud data
                const getResponse = await fetch(`${CLOUD_CONFIG.baseUrl}/${CLOUD_CONFIG.binId}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': CLOUD_CONFIG.jsonBinApiKey,
                        'X-Bin-Meta': 'false'
                    }
                });

                if (!getResponse.ok) {
                    throw new Error(`Failed to fetch cloud data: ${getResponse.status}`);
                }

                const cloudData = await getResponse.json();

                // Remove the completed order from cloud data
                cloudData.orders = cloudData.orders.filter(cloudOrder => 
                    cloudOrder.orderNumber !== orderNumber
                );

                // Update cloud data
                cloudData.lastUpdated = new Date().toISOString();
                cloudData.completedOrders = (cloudData.completedOrders || 0) + 1;

                // Upload updated data back to cloud
                const putResponse = await fetch(`${CLOUD_CONFIG.baseUrl}/${CLOUD_CONFIG.binId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': CLOUD_CONFIG.jsonBinApiKey
                    },
                    body: JSON.stringify(cloudData)
                });

                if (!putResponse.ok) {
                    throw new Error(`Failed to update cloud: ${putResponse.status}`);
                }

                // Remove from local orders
                const orderIndex = orders.findIndex(o => o.orderNumber === orderNumber);
                if (orderIndex !== -1) {
                    orders.splice(orderIndex, 1);
                }

                completedOrdersCount++;
                renderOrders();
                updateStatistics();

                showCloudStatus(`‚úÖ Order #${orderNumber} completed and deleted from cloud successfully!`, 'success');

                console.log(`‚úÖ Order ${orderNumber} completed and deleted from cloud`);

            } catch (error) {
                console.error('‚ùå Error completing order:', error);
                showCloudStatus(`‚ùå Failed to complete order: ${error.message}`, 'error');
            }
        }

        // Update statistics
        function updateStatistics() {
            const activeOrders = orders.filter(o => o.status !== 'completed').length;
            const activeTables = new Set(orders.filter(o => o.status !== 'completed').map(o => o.tableNumber)).size;

            document.getElementById('activeOrders').textContent = activeOrders;
            document.getElementById('activeTables').textContent = activeTables;
            document.getElementById('totalOrders').textContent = totalOrdersCount;
            document.getElementById('completedOrders').textContent = completedOrdersCount;
        }

        // Show cloud status
        function showCloudStatus(message, type = 'success') {
            const statusEl = document.getElementById('cloudStatus');
            const statusText = statusEl.querySelector('.status-text');

            statusText.textContent = message;
            statusEl.className = `cloud-status ${type}`;

            console.log(`Kitchen Status: ${message}`);
        }

        // Manual refresh
        function fetchOrdersManually() {
            fetchOrdersFromCloud(false);
        }

        // Initialize
        renderOrders();
        updateStatistics();

        console.log('‚úÖ Enhanced kitchen dashboard ready!');
        console.log('‚òÅÔ∏è Auto-sync enabled - checking every 5 seconds');
        console.log('üóëÔ∏è Cloud deletion enabled for completed orders');
        console.log('üçΩÔ∏è Ready to receive and manage orders');
    </script>
</body>
</html>
